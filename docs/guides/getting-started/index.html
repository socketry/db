<!DOCTYPE html>
<html>
	<head>
		
			<title>Getting Started</title>
		
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
		<link rel="icon" type="image/png" href="../../_static/icon.png"/>
		<link rel="stylesheet" href="../../_static/site.css" type="text/css" media="screen"/>
		
		<script src="../../_components/jquery/jquery.min.js"></script>
		<script src="../../_components/jquery-syntax/jquery.syntax.min.js"></script>
		
		<script type="text/javascript">
		//<![CDATA[
			jQuery(function($) {
				$.syntax();
			});
		//]]>
		</script>
	</head>

	<body class="">
		<nav> › <a class="link" href="../../index.html">Project</a> › <a class="link" href="../index.html">Guides</a></nav>
		
		
	<h1>Getting Started</h1>
	
	<main><p>This guide explains how to use <code>db</code> for database queries.</p>
<h2 id="installation">Installation</h2>
<p>Add the gem to your project:</p>
<pre><code class="language-bash">$ bundle add db
</code></pre>
<h2 id="core-concepts">Core Concepts</h2>
<p><code>db</code> has several core concepts:</p>
<ul>
<li>A <a href="../../source/DB/Client/index.html" title="DB::Client"><code class="language-ruby">class DB::Client</code></a> instance which is configured to connect to a specific database using an adapter, and manages a connection pool.</li>
<li>A <a href="../../source/DB/Context/Session/index.html" title="DB::Context::Session"><code class="language-ruby">class DB::Context::Session</code></a> instance which is bound to a specific connection and allows you to execute queries and enumerate results.</li>
</ul>
<h2 id="connecting-to-postgres">Connecting to Postgres</h2>
<p>Add the Postgres adaptor to your project:</p>
<pre><code class="language-bash">$ bundle add db-postgres
</code></pre>
<p>Set up the client with the appropriate credentials:</p>
<pre><code class="language-ruby">require 'async'
require 'db/client'
require 'db/postgres'

# Create the client and connection pool:
client = DB::Client.new(DB::Postgres::Adapter.new(database: 'test'))

# Create an event loop:
Sync do
	# Connect to the database:
	session = client.session
	
	# Execute the query and get a result set:
	result = session.call(&quot;SHOW SERVER_VERSION&quot;)
	
	# Convert the result set to an array and print it out:
	pp result.to_a
	# =&gt; [[&quot;12.3&quot;]]
	
ensure
	# Return the connection to the client connection pool:
	session.close
end
</code></pre>
<h2 id="connection-to-mariadb/mysql">Connection to MariaDB/MySQL</h2>
<p>Add the MariaDB adaptor to your project:</p>
<pre><code class="language-bash">$ bundle add db-mariadb
</code></pre>
<p>Set up the client with the appropriate credentials:</p>
<pre><code class="language-ruby">require 'async'
require 'db/client'
require 'db/mariadb'

# Create the client and connection pool:
client = DB::Client.new(DB::MariaDB::Adapter.new(database: 'test'))

# Create an event loop:
Sync do
	# Connect to the database:
	session = client.session
	
	# Execute the query and get a result set:
	result = session.call(&quot;SELECT VERSION()&quot;)
	
	# Convert the result set to an array and print it out:
	pp result.to_a
	# =&gt; [[&quot;10.4.13-MariaDB&quot;]]
	
ensure
	# Return the connection to the client connection pool:
	session.close
end
</code></pre>
<h2 id="streaming-results">Streaming Results</h2>
<p>Some database adaptors may stream results row by row. This reduces memory usage and latency. Because of that, you may only call <code class="language-ruby">#each</code> or <code class="language-ruby">#to_a</code> on a query result once.</p>
</main>

		
		<footer>Documentation generated by <a href="https://github.com/socketry/utopia-project">Utopia::Project</a>.</footer>
	</body>
</html>